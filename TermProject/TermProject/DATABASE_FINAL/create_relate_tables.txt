DROP TABLE ARTIST_MOVIE;

CREATE TABLE "ARTIST_MOVIE" (
  "role" VARCHAR2(30) NOT NULL,
  "aID" NUMBER NOT NULL,
  "mID" NUMBER NOT NULL,
  CONSTRAINT "ArtistMoviePk" PRIMARY KEY ("aID", "mID")
);

ALTER TABLE "ARTIST_MOVIE" ADD CONSTRAINT "Artist_Artist_Movie_Fk" FOREIGN KEY ("aID") REFERENCES ARTIST("aID") ON DELETE CASCADE;
ALTER TABLE "ARTIST_MOVIE" ADD CONSTRAINT "Movie_Artist_Movie_Fk" FOREIGN KEY ("mID") REFERENCES MOVIE("mID") ON DELETE CASCADE;


DROP TABLE ARTIST_SHOW;	

CREATE TABLE "ARTIST_SHOW" (
  "role" VARCHAR2(30) NOT NULL,
  "aID" NUMBER NOT NULL,
  "sID" NUMBER NOT NULL,
  CONSTRAINT "ArtistShowPk" PRIMARY KEY ("aID", "sID")
);

ALTER TABLE "ARTIST_SHOW" ADD CONSTRAINT "Artist_Artist_Show_Fk" FOREIGN KEY ("aID") REFERENCES ARTIST("aID") ON DELETE CASCADE;
ALTER TABLE "ARTIST_SHOW" ADD CONSTRAINT "Show_Artist_Show_Fk" FOREIGN KEY ("sID") REFERENCES SHOW("sID") ON DELETE CASCADE;


DROP TABLE MOVIE_GENRE;

CREATE TABLE "MOVIE_GENRE" (
  "mID" NUMBER NOT NULL,
  "gID" NUMBER NOT NULL,
  CONSTRAINT "MovieGenrePk" PRIMARY KEY ("mID", "gID")
);

ALTER TABLE "MOVIE_GENRE" ADD CONSTRAINT "Movie_Movie_Genre_Fk" FOREIGN KEY ("mID") REFERENCES MOVIE("mID") ON DELETE CASCADE;
ALTER TABLE "MOVIE_GENRE" ADD CONSTRAINT "Genre_Movie_Genre_Fk" FOREIGN KEY ("gID") REFERENCES GENRE("gID") ON DELETE CASCADE;


DROP TABLE SHOW_GENRE;

CREATE TABLE "SHOW_GENRE" (
  "sID" NUMBER NOT NULL,
  "gID" NUMBER NOT NULL,
  CONSTRAINT "ShowGenrePk" PRIMARY KEY ("sID", "gID")
);

ALTER TABLE "SHOW_GENRE" ADD CONSTRAINT "Show_Show_Genre_Fk" FOREIGN KEY ("sID") REFERENCES SHOW("sID") ON DELETE CASCADE;
ALTER TABLE "SHOW_GENRE" ADD CONSTRAINT "Genre_Show_Genre_Fk" FOREIGN KEY ("gID") REFERENCES GENRE("gID") ON DELETE CASCADE;


DROP TABLE "DIRECTOR_MOVIE";

CREATE TABLE "DIRECTOR_MOVIE" (
  "dID" NUMBER NOT NULL,
  "mID" NUMBER NOT NULL,
  CONSTRAINT "DirectorMoviePk" PRIMARY KEY ("dID", "mID")
);

ALTER TABLE "DIRECTOR_MOVIE" ADD CONSTRAINT "Director_Director_Movie_Fk" FOREIGN KEY ("dID") REFERENCES DIRECTOR("dID") ON DELETE CASCADE;
ALTER TABLE "DIRECTOR_MOVIE" ADD CONSTRAINT "Movie_Director_Movie_Fk" FOREIGN KEY ("mID") REFERENCES MOVIE("mID") ON DELETE CASCADE;


DROP TABLE "DIRECTOR_SHOW";

CREATE TABLE "DIRECTOR_SHOW" (
  "dID" NUMBER NOT NULL,
  "sID" NUMBER NOT NULL,
  CONSTRAINT "DirectorShowPk" PRIMARY KEY ("dID", "sID")
);

ALTER TABLE "DIRECTOR_SHOW" ADD CONSTRAINT "Director_Director_Show_Fk" FOREIGN KEY ("dID") REFERENCES DIRECTOR("dID") ON DELETE CASCADE;
ALTER TABLE "DIRECTOR_SHOW" ADD CONSTRAINT "Show_Director_Show_Fk" FOREIGN KEY ("sID") REFERENCES SHOW("sID") ON DELETE CASCADE


DROP TABLE "USER_MOVIE";
CREATE TABLE "USER_MOVIE" (
  "rating" FLOAT(53) NOT NULL,
  "usID" NUMBER NOT NULL,
  "mID" NUMBER NOT NULL,
  CONSTRAINT "UserMoviePk" PRIMARY KEY ("usID", "mID")
);

ALTER TABLE "USER_MOVIE" ADD CONSTRAINT "User_User_Movie_Fk" FOREIGN KEY ("usID") REFERENCES Users("usID") ON DELETE CASCADE;
ALTER TABLE "USER_MOVIE" ADD CONSTRAINT "Movie_User_Movie_Fk" FOREIGN KEY ("mID") REFERENCES Movie("mID") ON DELETE CASCADE;


DROP TABLE "USER_SHOW";
CREATE TABLE "USER_SHOW" (
  "rating" FLOAT(53) NOT NULL,
  "usID" NUMBER NOT NULL,
  "sID" NUMBER NOT NULL,
  CONSTRAINT "User_Show" PRIMARY KEY ("usID", "sID")
);

ALTER TABLE "USER_SHOW" ADD CONSTRAINT "User_User_Show_Fk" FOREIGN KEY ("usID") REFERENCES Users("usID") ON DELETE CASCADE;
ALTER TABLE "USER_SHOW" ADD CONSTRAINT "Show_User_Show_Fk" FOREIGN KEY ("sID") REFERENCES Show("sID") ON DELETE CASCADE;

ALTER TABLE "USER_MOVIE" 
ADD (
    "review" VARCHAR2(500),
    "rating_log" DATE,
    "review_log" DATE
);

ALTER TABLE "USER_SHOW" 
ADD (
    "review" VARCHAR2(500),
    "rating_log" DATE,
    "review_log" DATE
);

ALTER TABLE USER_MOVIE
MODIFY "rating" NUMBER NULL;

ALTER TABLE USER_SHOW
MODIFY "rating" NUMBER NULL;